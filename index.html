<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExtractFix</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/user.css">
    <link href="prism.css" rel="stylesheet" />
</head>

<body>
    <nav class="navbar navbar-default">
        <div class="container">
            <div class="navbar-header">
                <button class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navcol-1"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
                
            </div>
            <div class="collapse navbar-collapse" id="navcol-1">
            	<ul class="nav navbar-nav navbar-right">
                	<li rolt="presentation"><a class="btn btn-success btn-lg" role="button" href="download.html">Download</a></li>
            	</ul>
            </div>
        </div>
    </nav>
    <section>
    	<div class="hero">
	  		<div class="container">
	  			<div class="get-it">
	  				<h1 class="text-center"> ExtractFix </h1>
	  				<p class="text-center"> Beyond Tests: Program Vulnerability Repair via Crash Constraint Extraction </p>
	  			</div>
	  		</div>
	  	</div>
	  	<div class="container">
	  		<h1 class="text-left"> Overview</h1>
	  		<div class="abstract">
	  		<p> 
	  		<img src="architecture.jpg" align="right" height="250" weight="250">
	  		Automated program repair can be used to prevent exploitation of known security vulnerabilities by attackers. The large potential impact of security vulnerabilities means that the need to avoid incomplete or incorrect fixes is paramount. In this paper, we present a new mechanism for automatically generating provably correct repair of security vulnerabilities. Given a program vulnerability witnessed by some crashing input or exploit, our basic approach relies on extracting a constraint representation of the underlying cause of the crash.  This crash constraint can then be propagated backward to guide program repair over the space of possible fix locations. Our method synthesizes patch that is guaranteed to avoid repeating the original crash, thereby repairing the program for all program inputs not limited to a specific test suite.  As such, our approach helps address the test over-fitting problem (where a suggested repair fails to generalize beyond a given test suite).  An implementation of our method (ExtractFix) built on top of the KLEE symbolic execution engine shows its efficacy in fixing a wide range of vulnerabilities/bugs on subjects taken from CVEs and Google's Open-source-systems OSS Fuzz framework.</p>
	  		</div>
	  	</div>
        <div class="container">
            <h1 id="people">The patches generated by ExtractFix (24/30)</h1>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Subject</th>
                            <th>ID </th>
                            <th>Patch</th>
                            <th>Correctness </th>
                            <th>Bug Report</th>
                            <th>Developer Fix</th>
                        </tr>
                    </thead>
		            <tbody>
                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2016-5321</td>
                            <td><pre><code class="language-diff">     for (col = 0; col < imagewidth; col += tw){
-         for (s = 0; s < spp; s++)
+         for (s = 0; s < spp && s < 8; s++)
          {  /* Read each plane of a tile set into srcbuffs[s] */"</code></pre></td>
                            <td>Syntactic equivalent</td>
                            <td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2558">report</a></td>
                            <td><a href="https://github.com/vadz/libtiff/commit/d9783e4">d9783e4</a></td>
                        </tr>
                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2014-8128</td>
                            <td><pre><code class="language-diff">    rows[0] = br + bpr*sy;
	err += step;
-   while (err >= limit)
+   while (err >= limit && nrows <256)
	    err -= limit;
	    sy++;</code></pre></td>
                            <td>Semantically equivalent</td>
                            <td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2489">report</a></td>
                            <td><a href="https://github.com/vadz/libtiff/commit/3206e0c">3206e0c</a></td>
                        </tr>
                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2016-3186</td>
                            <td><pre><code class="language-diff">-  while ((count = getc(infile)) && count <= 255)        
+  while ((count = getc(infile)) && count >= 0 && count <= 255)	</code></pre></td>
                            <td>Syntactic equivalent</td>
                            <td><a href="https://bugzilla.redhat.com/show_bug.cgi?id=1319503">report</a></td>
                            <td><a href="https://bugzilla.redhat.com/attachment.cgi?id=1144235&action=diff">1144235</a></td>
                        </tr>

                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2016-5314</td>
                            <td><pre><code class="language-diff"> ---
							</code></pre></td>
							<td>Fail</td>
                            <td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2554">report</a></td>
                            <td><a href="https://github.com/vadz/libtiff/commit/391e77f">391e77f</a></td>
                        </tr>
                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2016-9273</td>
                            <td><pre><code class="language-diff"> ---
							</code></pre></td>
							<td>Fail</td>
                            <td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2587">report</a></td>
                            <td><a href="https://github.com/vadz/libtiff/commit/d651abc">d651abc</a></td>
                        </tr>

                        <tr>
                            <td>Libtiff</td>
                            <td>bugzilla 2633</td>
                            <td><pre><code class="language-diff">//define global variable to record buffer size/base
-    malloc(size);
+    global_size_cp = size;
+    malloc(global_size_cp);

// patch based on predefined global buffer size/base 
-    for (; cc < tf_bytesperrow; cc += samplesperpixel) {
+    for (; cc < tf_bytesperrow && nc+3 < global_size_cp; cc += samplesperpixel) {</code></pre></td>
							<td>Plausible</td>
							<td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2633">report</a></td>
							<td><a href="https://github.com/vadz/libtiff/commit/5ed9fea">5ed9fea</a></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2016-10094</td>
                            <td><pre><code class="language-diff">//define global variable to record buffer size/base
-    malloc(size);
+    global_size_buffer = size;
+    malloc(global_size_buffer);

// patch based on predefined global buffer size/base 
     int retTIFFReadRawTile;
     /* Ignore EOI marker of JpegTables */
     _TIFFmemcpy(buffer, jpt, count - 2);
-    bufferoffset += count - 2;
+    bufferoffset = (-1+(global_size_buffer-count));
     /* Store last 2 bytes of the JpegTables */</code></pre></td>
                            <td>Plausible</td>
                            <td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2640">report</a></td>
                            <td><a href="https://github.com/vadz/libtiff/commit/c715336">c715336</a></td>
                        </tr>
                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2017-7601</td>
                            <td><pre><code class="language-diff">+        if( td->td_bitspersample > 64 )
+        {
+            return (0);
+        }</code></pre></td>
							<td>Plausible</td>
                            <td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2648">report</a></td>
                            <td><a href="https://github.com/vadz/libtiff/commit/0a76a8">0a76a8</a></td>
                        </tr>
                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2016-3623</td>
                            <td><pre><code class="language-diff">+    if (vertSubSampling == 0) return 1;
							</code></pre></td>
							<td>Semantically equivalent</td>
							<td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2569">report</a></td>
							<td><a href="https://github.com/vadz/libtiff/commit/bd024f0">bd024f0</a></td>
                        </tr>
                        <tr>
                            <td>Libtiff</td>
                            <td>CVE-2017-7595</td>
                            <td><pre><code class="language-diff">+    if (sp->h_sampleing == 0) return 1;
                            </code></pre></td>
                            <td>Semantically equivalent</td>
							<td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2653">report</a></td>
							<td><a href="https://github.com/vadz/libtiff/commit/47f2fb6">47f2fb6</a></td>
                        </tr>
                        <tr>
                            <td>Libtiff</td>
                            <td>bugzilla 2611</td>
                            <td><pre><code class="language-diff">-    if (cc%sp->bytes_per_line!=0)
+    if (sp->bytes_per_line == 0 || cc%sp->bytes_per_line!=0)</code></pre></td>
							<td>Semantically equivalent</td>
							<td><a href="http://bugzilla.maptools.org/show_bug.cgi?id=2611">report</a></td>
							<td><a href="https://github.com/vadz/libtiff/commit/43bc25">43bc25</a></td>
                        </tr>
                        
                        
                        
                        
                        <tr>
                            <td>Binutils</td>
                            <td>CVE-2018-10372</td>
                            <td><pre><code class="language-diff">//define global variable to record buffer size/base
-    signature = malloc(size);
+    global_size_signature = size;
+    signature = malloc(global_size_signature);
+    global_base_signature = signature;

// patch based on predefined global buffer size/base 
+    if (ph + num_copy >= global_base_signature + global_size_signature)
+    return 0;</code></pre></td>
                            <td>Plausible</td>
							<td><a href="https://bugzilla.gnome.org/show_bug.cgi?id=763071">report</a></td>
							<td><a href="https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;h=6aea08d">6aea08</a></td>
                        </tr>
                        <tr>
                            <td>Binutils</td>
                            <td>CVE-2017-15025</td>
                            <td><pre><code class="language-diff">     case DW_LNS_const_add_pc:
+    if (lh.line_range == 0)
+        return 0;</code></pre></td>
                            <td>Semantically equivalent</td>
							<td><a href="https://bugzilla.gnome.org/show_bug.cgi?id=758605">report</a></td>
							<td><a href="https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;h=d8010d3">d8010d3</a></td>
                        </tr>
                        
                        
                        
                        
                        <tr>
                            <td>Libxml2</td>
                            <td>CVE-2016-1834</td>
                            <td><pre><code class="language-diff">-    if (len < 0))
+    if (len<0 || size < 0 || len>Max+size))"</code></pre></td>
                            <td>Plausible</td>
							<td><a href="https://bugzilla.gnome.org/show_bug.cgi?id=763071">report</a></td>
							<td><a href="https://gitlab.gnome.org/GNOME/libxml2/commit/8fbbf5">8fbbf551</a></td>
                        </tr>
                        <tr>
                            <td>Libxml2</td>
                            <td>CVE-2016-1838</td>
                            <td><pre><code class="language-diff">//define global variable to record buffer size/base
-    malloc(size);
+    global_size_cur = size;
+    malloc(global_size_cur);

// patch based on predefined global buffer size/base 
    if ((tlen > 0) && (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0)) {
-       if (ctxt->input->cur[tlen] == '>') {
+       if (tlen + 1 < global_size_cur) && (ctxt->input->cur[tlen] == '>')) {	</code></pre></td>
                            <td>Plausible</td>
							<td><a href="https://bugzilla.gnome.org/show_bug.cgi?id=758588">report</a></td>
							<td><a href="https://gitlab.gnome.org/GNOME/libxml2/commit/db07dd6">db07dd6</a></td>
                        </tr>
                        <tr>
                            <td>Libxml2</td>
                            <td>CVE-2016-1839</td>
                            <td><pre><code class="language-diff"> --- 
                            </code></pre></td>
                            <td>Fail</td>
							<td><a href="https://bugzilla.gnome.org/show_bug.cgi?id=758605">report</a></td>
							<td><a href="https://gitlab.gnome.org/GNOME/libxml2/commit/a820dbe">a820dbe</a></td>
                        </tr>
                        <tr>
                            <td>Libxml2</td>
                            <td>CVE-2012-5134</td>
                            <td><pre><code class="language-diff"> if ((in_space) && (normalize)) {
-    while (buf[len - 1] == 0x20) len--;
+    while ((len > 0) && (buf[len - 1] == 0x20)) len--;    
 }
 buf[len] = 0;
</code></pre></td>
                            <td>Syntactic equivalent</td>
							<td><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=158249">report</a></td>
							<td><a href="https://gitlab.gnome.org/GNOME/libxml2/commit/6a36fbe">6a36fbe</a></td>
                        </tr>
                        <tr>
                            <td>Libxml2</td>
                            <td>CVE-2017-5969</td>
                            <td><pre><code class="language-diff">-    if ((content->c1->type == XML_ELEMENT_OR) ||
-        (content->c1->type == XML_ELEMENT_SEQ))
+   if ((content->c1 != NULL) &&
+       ((content->c1->type == XML_ELEMENT_OR) ||
+       (content->c1->type == XML_ELEMENT_SEQ)))</code></pre></td>
                            <td>Syntactic equivalent</td>
							<td><a href="https://bugzilla.gnome.org/show_bug.cgi?id=778519">report</a></td>
							<td><a href="https://gitlab.gnome.org/GNOME/libxml2/commit/
94691dc8">94691dc8</a></td>
                        </tr>
                        
                        
                        
                        
                        <tr>
                            <td>Libjpeg</td>
                            <td>CVE-2018-14498</td>
                            <td><pre><code class="language-diff">//define global variable to record buffer size/base
-    malloc(size);
+    global_size_cp = size;
+    malloc(global_size_cp);

// patch based on predefined global buffer size/base
+    if (t >= global_size_cp)
+         ERREXIT(cinfo);
     *outptr++ = colormap[0][t]; /* can omit GETJSAMPLE() safely */</code></pre></td>
                            <td>Plausible</td>
							<td><a href="https://github.com/libjpeg-turbo/libjpeg-turbo/issues/258">report</a></td>
							<td><a href=""https://github.com/libjpeg-turbo/libjpeg-turbo/commit/cbe01e0c6757c918a220a63ce614fe77260a7a03"">cbe01e</a></td>
                        </tr>
                        
                        <tr>
                            <td>Libjpeg</td>
                            <td>CVE-2018-19664</td>
                            <td><pre><code class="language-diff">---
							</code></pre></td>
                            <td>Fail</td>
							<td><a href="https://github.com/libjpeg-turbo/libjpeg-turbo/issues/305">report</a></td>
							<td><a href=""https://github.com/libjpeg-turbo/libjpeg-turbo/commit/1ecd9a"">1ecd9a</a></td>
                        </tr>
                        
                        <tr>
                            <td>Libjpeg</td>
                            <td>CVE-2017-15232</td>
                            <td><pre><code class="language-diff">+    if (output_buf == NULL && num_rows) {
+        ERREXIT(0);
+    }</code></pre></td>
                            <td>Semantically equivalent</td>
							<td><a href="https://github.com/mozilla/mozjpeg/issues/268">report</a></td>
							<td><a href=""https://github.com/libjpeg-turbo/libjpeg-turbo/commit/1ecd9a5"">1ecd9a5</a></td>
                        </tr>
                        <tr>
                            <td>Libjpeg</td>
                            <td>CVE-2012-2806</td>
                            <td><pre><code class="language-diff">-  for (i = 0; i < cinfo->num_components; i++)
+  for (i = 0; i < 4; i++)
     cinfo->cur_comp_info[i] = NULL;
   for (i = 0; i < n; i++) {
     INPUT_BYTE(cinfo, cc, return FALSE);
     INPUT_BYTE(cinfo, c, return FALSE);
-    for (ci = 0, compptr = cinfo->comp_info; ci < cinfo->num_components;
+    for (ci = 0, compptr = cinfo->comp_info; ci < cinfo->num_components && ci < 4;</code></pre></td>
                            <td>Semantically equivalent</td>
							<td><a href="https://github.com/mozilla/mozjpeg/issues/268">report</a></td>
							<td><a href=""https://github.com/libjpeg-turbo/libjpeg-turbo/commit/dd2b651"">dd2b651</a></td>
                        </tr>
                        
                        
                        
                        
                        <tr>
                            <td>Coreutils</td>
                            <td>Bugzilla 26545</td>
                            <td><pre><code class="language-diff">-    for (i = 3; i < size / 2; i *= 2)
+    for (i = 3; i <= size / 2; i *= 2)
         memcpy (r + i, r, i);
     if (i < size)
         memcpy (r + i, r, size - i);</code></pre></td>
                            <td>Syntactic equivalent</td>
							<td><a href="https://debbugs.gnu.org/cgi/bugreport.cgi?bug=26545">report</a></td>
							<td><a href="https://github.com/coreutils/coreutils/commit/f4570a9e">f4570a</a></td>
                        </tr>
                        <tr>
                            <td>Coreutils</td>
                            <td>GNUBug 25003</td>
                            <td><pre><code class="language-diff">     end = (k == n) ? file_size : k * (file_size / n);
-    if (initial_read != SIZE_MAX || start < initial_read)
+    if (start < initial_read){
         memmove (buf, buf + start, initial_read - start);
         initial_read -= start;</code></pre></td>
                            <td>Syntactic equivalent</td>
							<td><a href="https://debbugs.gnu.org/cgi/bugreport.cgi?bug=25003">report</a></td>
							<td><a href="https://github.com/coreutils/coreutils/commit/4954f79">4954f79</a></td>
                        </tr>
                        <tr>
                            <td>Coreutils</td>
                            <td>GNUBug 25023</td>
                            <td><pre><code class="language-diff">---
                            </code></pre></td>
                            <td>Fail</td>
							<td><a href="https://debbugs.gnu.org/cgi/bugreport.cgi?bug=25023">report</a></td>
							<td><a href="https://github.com/coreutils/coreutils/commit/d91aee">d91aee</a></td>
                        </tr>
                        <tr>
                            <td>Coreutils</td>
                            <td>Bugzilla 19784</td>
                            <td><pre><code class="language-diff">---
                            </code></pre></td>
                            <td>Fail</td>
							<td><a href="https://debbugs.gnu.org/cgi/bugreport.cgi?bug=19784">report</a></td>
							<td><a href="https://github.com/coreutils/coreutils/commit/1d0f1b7">1d0f1b7</a></td>
                        </tr>
                        
                        
                        
                        
                        <tr>
                            <td>Jasper</td>
                            <td>CVE-2016-8691</td>
                            <td><pre><code class="language-diff">+   if(cmpt->hstep)
+        return 0;
     cmpt->width = JPC_CEILDIV(dec->xend, cmpt->hstep) -
		  JPC_CEILDIV(dec->xstart, cmpt->hstep);</code></pre></td>
                            <td>Semantically equivalent</td>
							<td><a href="https://blogs.gentoo.org/ago/2016/10/16/jasper-two-divide-by-zero-in-jpc_dec_process_siz-jpc_dec-c/">report</a></td>
							<td><a href="https://github.com/mdadams/jasper/commit/d8c2604cd438c41ec72aff52c16ebd8183068020">d8c2604</a></td>
                        </tr>
                        <tr>
                            <td>Jasper</td>
                            <td>CVE-2016-9387</td>
                            <td><pre><code class="language-diff">+    if(dec->yend <= dec->tileyoff)
+        return -1;
     dec->numvtiles = JPC_CEILDIV(dec->yend - dec->tileyoff, dec->tileheight);
     dec->numtiles = dec->numhtiles * dec->numvtiles;</code></pre></td>
                            <td>Plausible</td>
							<td><a href="https://blogs.gentoo.org/ago/2016/11/16/jasper-multiple-assertion-failure/">report</a></td>
							<td><a href="https://github.com/mdadams/jasper/commit/d91198abd00fc435a397fe6bad906a4c1748e9cf">d91198a</a></td>
                        </tr>
                        
                        
                        
                        
                        <tr>
                            <td>FFmpeg</td>
                            <td>CVE-2017-9992</td>
                            <td><pre><code class="language-diff">//define global variable to record buffer size/base
-    frame = malloc(size);
+    global_size_frame = size;
+    frame = malloc(global_size_frame);
+    global_base_frame = frame;

// patch based on predefined global buffer size/base 
-    if (frame_end - frame < width + 3)
+    if (global_base_frame + global_size_frame - frame < width + 4)
         return AVERROR_INVALIDDATA;
         frame[0] = frame[1] = </code></pre></td>
                            <td>Semantic equivalent</td>
							<td><a href="https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=1345">report</a></td>
							<td><a href="https://github.com/FFmpeg/FFmpeg/commit/f52fbf4f3ed02a7d872d8a102006f29b4421f360">f52fbf4</a></td>
                        </tr>
                        <tr>
                            <td>FFmpeg</td>
                            <td>Bugzilla-1404</td>
                            <td><pre><code class="language-diff">    h->sym_factor = h->dist[0] * h->scale_den[1];
+    if (h->sym_factor > 32768) {
+        return AVERROR_INVALIDDATA;</code></pre></td>
                            <td>Semantic equivalent</td>
							<td><a href="https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=1404">report</a></td>
							<td><a href="https://github.com/FFmpeg/FFmpeg/commit/279420b5a63b3f254e4932a4afb91759fb50186a">279420b</a></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td><pre><code class="language-diff">

							</code></pre></td>
                            <td> </td>
							<td> </td>
							<td> </td>
                        </tr>
                        
                        
                        
                        
                    </tbody>
                </table>
            </div>
        </div>
    </section>
    <footer class="site-footer">
        <div class="container">
            <div class="row">
            </div>
        </div>
    </footer>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="prism.js"></script>
</body>

</html>
